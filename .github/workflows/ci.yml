name: CI
needs: test
runs-on: ubuntu-latest
if: github.event_name == 'push' && startsWith(github.ref, 'refs/tags/v')
steps:
- uses: actions/checkout@v4
- name: Set up Python
uses: actions/setup-python@v4
with:
python-version: 3.11
- name: Install build deps
run: python -m pip install --upgrade pip setuptools wheel cibuildwheel==2.* twine
- name: Build wheels (Linux & Windows)
uses: docker://quay.io/pypa/manylinux2014_x86_64:latest
with:
entrypoint: /bin/bash
args: -lc "python -m pip install --upgrade pip setuptools wheel cibuildwheel==2.* && cibuildwheel --output-dir wheelhouse"
- name: Upload wheels to artifact
uses: actions/upload-artifact@v4
with:
name: wheels
path: wheelhouse/*.whl
- name: Create GitHub Release
id: create_release
uses: softprops/action-gh-release@v1
with:
tag_name: ${{ github.ref }}
env:
GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
- name: Upload release assets
uses: actions/upload-release-asset@v1
with:
upload_url: ${{ steps.create_release.outputs.upload_url }}
asset_path: ./wheelhouse
asset_name: wheelhouse
asset_content_type: application/zip


windows-build:
needs: test
runs-on: windows-latest
strategy:
matrix:
python-version: [3.9, 3.10, 3.11]
steps:
- uses: actions/checkout@v4
- name: Set up Python
uses: actions/setup-python@v4
with:
python-version: ${{ matrix.python-version }}
- name: Install build deps
run: python -m pip install --upgrade pip setuptools wheel cibuildwheel==2.*
- name: Build wheel (windows)
run: |
python -m pip install --upgrade pip
cibuildwheel --platform windows --output-dir wheelhouse
- name: Upload wheels
uses: actions/upload-artifact@v4
with:
name: windows-wheels
path: wheelhouse/*.whl